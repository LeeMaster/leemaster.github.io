---
title: 基于 Vue-element-admin 的讨论
date: 2019-01-17 23:52:57
categories:
- 前端技术
tags:
- vue
---

前一段时间的工作中，使用Vue自己封装了一个通用的中台管理系统，但是和这个项目比较起来还是比较low的，基于vue-element-admin(下文称vea)这个框架的学习和思考，探讨一些我自己关于公司规模化前端中台框架封装的思考。

<!--more-->


# 前情提要

之前从事的工作主要在后端，而且基本对前端来说也是半吊子感觉，还是在用传统的CSS和JS，就是能随便写点东西，但是到封装框架的地步还是不行的，但是最近的工作确实让我脑壳很疼，加入朋友的公司以后，很坑的是之前的遗留问题，而且对于目前的几个正在进行的项目来说，可能老版本的Css已经不能适应一些要求了，同时对于Es5 还有一些jquery最糟糕的实践全都出现了，所以我建议前端团队开始尝试VUE等一些MVVM框架，并且开始学习Sass 语言来进行书写样式表。

# 导航部分

对于一个服务的中台页面来说，导航肯定是很重要的，我们需要让我们的用户很快的找到他需要的功能。

## 顶导

顶部导航，在所谓的设计的角度来看，主要是一些系统性操作，比如用户登陆和退出，以及跳转其他页面的能力，基本我们会发现，我们的用户信息修改这些事情，可能并不需要在一个中台系统内有所体现，都会路由到SSO系统内进行处理，当然，在开发上我们仍然需要保持这种能力，即既能跳转新页面，还能本地开组件。

那么剩下的一些功能也是系统性的，比如什么全屏显示了呀，什么换换主题啦。

当然面包屑也是需要的，从这里开始我们会发现，我们的侧导和顶导开始交互了，同时我们tabs化的功能也会开始交互，不过这也还是小case。

## 侧导

侧边导航，可以在右边也可以在左边，目前的设计基本都是可以进行折叠，那么这个时候我们就需要做一些东西来让我们的侧导可以被控制了，不过我不太认同，vea内的vuex化，将折叠等属性放入store内，我个人更倾向于组件内聚，让组件自己管理自己。但是这样会带来一些问题，比如通过事件传递侧导的状态改变，处理多种交互时候的同时改变。

这里使用vue指令，我觉得还是很靠谱的，可以将侧导的折叠属性抽离出来，做成指令，这样就很棒了，当然还是会引入vuex，不过vuex本来就是做这个事情的，那么，我觉得为了体现通用，和多组件能力，我们尽量能打包为vue template 就打包为vue template 从而可以进行修改和扩展。

这里最关键的技术应该是vue的递归组件的使用，毕竟我推荐侧导层级不要超过三层，不然会有点小麻烦。

## Tabs 化组件

所谓的tab化，就是所谓的开启新窗口模式，可以随时的开启新窗口，如操作系统中的开启新的程序一样，在很早以前的模式都是用iframe，但是iframe确实比较坑，具体的大坑没有碰见过。

但是这里完全可以采用两种模式，动态组件方案和iframe模式，两种模式来进行处理，从而做到比较靠谱的多任务模型，当然vea的组件缓存确实让我比较惊讶，可能之前没有用过把，这样状态保存的问题就能得到有效的解决了。

## 导航权限

vea的权限做到了组件上，这个是一个很棒的思路，但是我觉得可能需要考虑一下后端管理的问题，我们怎么切分业务，并且组织组件是一个很知道考虑问题，我觉得我们对一个组件来说，一个组件就有一个权限，一个权限可以归属多个角色，那么我觉得如果开发了一个组件就需要填入一个新的权限，我总结了一个权限思路。

* 我认为一个业务组件可能包含原子业务组件
* 一个原子业务组件应该具有一个permission
* 一个原子业务组件下使用的基础组件应该是通用的无特殊权限设置的。

## 滚动

首先我们的侧导需要能进行滚动，而我们的内容部分也需要进行滚动，所以可以做一些scroll事件来管理这个东西，同时需要处理宽高，可以直接抽象成组件进行使用

# 行为部分

觉得说行为，其实是在表明用户的行为对系统产生的影响，因为我认为前端就是个巨大的状态机

## 登陆行为

登陆行为，这里vea做成了一个页面直接登陆，并且hook了逻辑，个人感觉这里完全没必要对UI进行体现，我觉得既然是全局的状态，那么是否可以抽象出来全局的一个action之类的东西，帮助直接屏蔽UI细节。

## 退出行为

这个的话，可能需要调一下后端接口，保证cookie之类的全部清除掉

## 上传行为

这种行为的话个人认为还是，做各种抽象接口比较实际，抽象完成之后，进行组件的抽象，还是抽离逻辑和UI
